optim_df
optim_df <- optim_mll(envdat, occ, numstarts = 1000, parallel = TRUE)
optim_df
optim_df %>% ggplot() + geom_density(aes(mu1))
library(tidyverse)
install.packages("tidyverse")
optim_df %>%
ggplot() + geom_density(aes(mu1))
libary("tidyverse")
library("tidyverse")
optim_df %>%
ggplot() + geom_density(aes(mu1))
optim_df
optim_df
View(optim_df)
param_list_example
optim_df
optim_df %>% summarise(mu1 = median(mu1))
optim_df
optim_df
View(optim_df)
bio1_ts
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
envData <- list(bio1 = bio1_ts, bio12 = bio12_ts)
envdat <- envDataArray(envData, occ = sp_virtual_example)
occ <- sp_virtual_example$presence
optim_df <- optim_mll(envdat, occ, numstarts = 1000, parallel = TRUE)
optim_df
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
envData <- list(bio1 = bio1_ts, bio12 = bio12_ts)
envdat <- envDataArray(envData, occ = sp_virtual_example)
occ <- sp_virtual_example$presence
optim_df <- optim_mll(envdat, occ, numstarts = 100, parallel = TRUE)
param_list_example
optim_df %>%
ggplot() + geom_density(aes(mu1))
optim_df
optim_df %>%
summarise(mu1 = median(mu1))
optim_df %>%
summarise(mu1 = mean(mu1))
optim_df
optim_df
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
bio1_ts
bio12_ts
loglik_orthog_nd_unconstr
?math_to_bio
math_to_bio
expit(0.9)
expit(0.999)
expit(100)
expit(10)
sp_virtual_example
param_list
envdat
occ
list_of_pars
loglik_orthog_nd_unconstr
envdat <- envdat_ex
pa <- occExample
params <- paramTableExample[5, ]
params
param_vector <- params
loglik_orthog_nd_unconstr(params, envdat, pa)
pa
loglik_orthog_nd_unconstr
params
envdat
pa
envdat
envdat
params
math_to_bio(params)
RcppParallel::defaultNumThreads()%/%4
param_list
loglik_orthog_nd
loglik_orthog_nd_unconstr(params, envdat, pa)
params
envdat
envdat
pa
loglik_orthog_nd_unconstr(params, envdat, pa)
occ <- mus_virtualis[1:5, ]
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
envData <- list(bio1 = bio1_ts, bio12 = bio12_ts)
envArray <- xsdmMle::envDataArray(envData)
param_list <-list(
mu = c(2, 250)
,sigl = c(0.5, 150)
,sigr = c(1.5, 75)
,c = -1.5
,pd = 0.9
,O = matrix(c(1, 0, 0, 1), ncol = 2)
)
param_list_example <- param_list
param_list_example
r_vsp <- xsdmMle:::vsp(envData = envData,
param_list =  param_list)
r_vsp
r_vsp <- exp(r_vsp)
probs <- suppressWarnings(do.call(f_par, args = param_list))
M <- logprobdetect(envArray, mu, sigLtil, sigRtil, ctil, pd, O)
#plot(r_vsp - M)
M <- exp(M)
r <- cbind(crds(bio1_ts), M) |>
as.data.frame() |>
rast()
crs(r) <- crs(bio1_ts)
plot(r)
?terra::spatSample
r_vsp_presence <- as.data.frame(r_vsp,  xy = TRUE) %>%
tibble::tibble() %>%
dplyr::mutate(probs = ifelse(probs > 0.5, probs, NA)) %>%
terra::rast( crs = crs(r_vsp))
r_vsp_absence <- as.data.frame(r_vsp,  xy = TRUE) %>%
tibble::tibble() %>%
dplyr::mutate(probs = ifelse(probs < 0.5, probs, NA)) %>%
terra::rast( crs = crs(r_vsp))
panel(c(r_vsp_absence, r_vsp_presence))
r_vsp_presence %>% as.data.frame() %>% nrow()
presence_points <- spatSample(r_vsp_presence, size = 30, na.rm=TRUE, xy = TRUE)
absence_points <- spatSample(r_vsp_absence, size = 30, na.rm=TRUE, xy = TRUE)
presence_points <- presence_points %>%
rbind(absence_points) |>
rename(longitude = x, latitude = y)
presence_points$occurence <- rbinom(nrow(presence_points),
1,
presence_points$probs)
pts_occ <- presence_points %>% filter(occurence == 1) %>% vect(geom = c("longitude", "latitude"))
pts_abs <- presence_points %>% filter(occurence == 0) %>% vect(geom = c("longitude", "latitude"))
plot(r_vsp)
points(pts_occ, col = "red")
points(pts_abs, col = "black")
sp_virtual_example <- presence_points %>%
mutate(name  = "spVirtual") %>%
rename(presence = occurence) %>%
select(name, latitude, longitude, presence)
usethis::use_data(sp_virtual_example)
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
envData <- list(bio1 = bio1_ts, bio12 = bio12_ts)
envdat <- envDataArray(envData, occ = sp_virtual_example)
envdat
occ <- sp_virtual_example$presence
occ
optim_df <- optim_mll(envdat, occ, numstarts = 100, parallel = TRUE)
optim_df <- optim_mll(envdat, occ, numstarts = 100, parallel = FALSE)
envdat
params
list_of_pars
param_vector
envdat <- envdat_ex
pa <- occExample
params <- paramTableExample[5, ]
param_vector <- params
loglik_orthog_nd_unconstr(params, envdat, pa)
params
params
param_vector
math_to_bio(param_vector)
params
paramTableExample
paramTableExample %>% tibble()
params
math_to_bio(paramTableExample)
math_to_bio(params)
paramTable
envdat_ex_occ
startparms(envdat_ex_occ)
startparms(envdat_ex_occ)
startParamsEx <-
startParamsEx <- startparms(envdat_ex_occ)
startParamsEx
math_to_bio(startParamsEx)
math_to_bio(startParamsEx[1, ])
math_to_bio(startParamsEx[2, ])
math_to_bio(startParamsEx[3, ])
math_to_bio(startParamsEx[4, ])
math_to_bio(startParamsEx[1, ])
math_to_bio(startParamsEx[2, ])
params
loglik_orthog_nd_unconstr(params, envdat, pa)
devtools::build_manual()
devtools::document()
usethis::use_readme_rmd()
pak::pak("alrobles/xsdmMle")
devtools::document()
devtools::build_readme()
envdat_ex
occExample
envdat_ex
envdat_ex[ ,2,]
envdat_ex[ 2,,]
envdat_ex
envdat_ex
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
bio12_ts
minmax(bio12_ts)
terra::minmax(bio12_ts)
bio12_ts <- bio12_ts/100
bio12_ts
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
bio12_ts <- bio12_ts/100
envData <- list(bio1 = bio1_ts, bio12 = bio12_ts)
envdat <- envDataArray(envData, occ = sp_virtual_example)
envdat
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
bio12_ts/100
bio12_ts <- bio12_ts/100
envData <- list(bio1 = bio1_ts, bio12 = bio12_ts)
envArray <- xsdmMle::envDataArray(envData)
envArray
param_list <-list(
mu = c(2, 3)
,sigl = c(0.5, 1)
,sigr = c(1.5, 0.75)
,c = -1.5
,pd = 0.9
,O = matrix(c(1, 0, 0, 1), ncol = 2)
)
param_list
r_vsp <- xsdmMle:::vsp(envData = envData,
param_list =  param_list)
r_vsp
r_vsp <- exp(r_vsp)
probs <- suppressWarnings(do.call(f_par, args = param_list))
param_list
r_vsp
r_vsp <- exp(r_vsp)
r_vsp
r_vsp <- xsdmMle:::vsp(envData = envData,
param_list =  param_list)
r_vsp
plot(r_vsp)
;library(terra)
library(terra)
plot(r_vsp)
r_vsp_presence <- as.data.frame(r_vsp,  xy = TRUE) %>%
tibble::tibble() %>%
dplyr::mutate(probs = ifelse(probs > 0.5, probs, NA)) %>%
terra::rast( crs = crs(r_vsp))
library(terra)
r_vsp_presence <- as.data.frame(r_vsp,  xy = TRUE) %>%
tibble::tibble() %>%
dplyr::mutate(probs = ifelse(probs > 0.5, probs, NA)) %>%
terra::rast( crs = crs(r_vsp))
r_vsp_absence <- as.data.frame(r_vsp,  xy = TRUE) %>%
tibble::tibble() %>%
dplyr::mutate(probs = ifelse(probs < 0.5, probs, NA)) %>%
terra::rast( crs = crs(r_vsp))
panel(c(r_vsp_absence, r_vsp_presence))
r_vsp_presence %>% as.data.frame() %>% nrow()
presence_points <- spatSample(r_vsp_presence, size = 30, na.rm=TRUE, xy = TRUE)
absence_points <- spatSample(r_vsp_absence, size = 30, na.rm=TRUE, xy = TRUE)
presence_points <- presence_points %>%
rbind(absence_points) |>
rename(longitude = x, latitude = y)
presence_points$occurence <- rbinom(nrow(presence_points),
1,
presence_points$probs)
pts_occ <- presence_points %>% filter(occurence == 1) %>% vect(geom = c("longitude", "latitude"))
pts_abs <- presence_points %>% filter(occurence == 0) %>% vect(geom = c("longitude", "latitude"))
plot(r_vsp)
points(pts_occ, col = "red")
points(pts_abs, col = "black")
sp_virtual_example <- presence_points %>%
mutate(name  = "spVirtual") %>%
rename(presence = occurence) %>%
select(name, latitude, longitude, presence)
sp_virtual_example
usethis::use_data(sp_virtual_example)
usethis::use_data(sp_virtual_example, overwrite = TRUE)
# param_list_example <- param_list
usethis::use_data(param_list_example, overwrite = TRUE)
devtools::document()
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
bio12_ts <- bio12_ts/100
envData <- list(bio1 = bio1_ts, bio12 = bio12_ts)
envdat <- envDataArray(envData, occ = sp_virtual_example)
envdat
occ <- sp_virtual_example$presence
occ
optim_df <- optim_mll(envdat, occ, numstarts = 100, parallel = FALSE)
optim_df
param_list_example
optim_df
optim_df <- optim_mll(envdat, occ, numstarts = 1000, parallel = TRUE)
optim_df
?ucminf::ucminf
bio1_ts <- terra::unwrap(cmcc_cm_bio1)
bio12_ts <- terra::unwrap(cmcc_cm_bio12)
bio12_ts <- bio12_ts/100
envData <- list(bio1 = bio1_ts, bio12 = bio12_ts)
envdat <- envDataArray(envData, occ = sp_virtual_example)
optim_df <- optim_mll(envdat, occ, numstarts = 500, parallel = TRUE)
envdat
optim_df
bio12_ts
optim_df
optim_df <- optim_mll(envdat, occ, numstarts = 50, parallel = TRUE)
param_list_example
optim_df
logit(1.32)
expit(1.32)
envdat
envData
sp_virtual_example
envdat
occ
devtools::build_readme()
report()
library(covr)
report()
report()
usethis::use_test("like_ltsg")
mu
library(testhat)
library(testthat)
# Create small matrices with incompatible dimensions
mu <- c(1, 2)
ortho_m <- matrix(1:4, nrow = 2, ncol = 2)   # 2x2
env_m <- matrix(1:6, nrow = 3, ncol = 2)     # 3x2 (incompatible: ortho_m.ncol != env_m.nrow)
dl_mat <- diag(2)
drl_mat <- diag(2)
drl_mat
dl_mat
# Expect an error with the specific message
expect_error(
like_ltsg(mu, env_m, dl_mat, drl_mat, ortho_m, q = 1, r = 2),
"Matrix dimensions are not compatible for multiplication."
)
like_ltsg
library(xsdmMle)
like_ltsg
xsdmMle:::like_ltsg
devtools::document()
devtools::document()
Rcpp::compileAttributes()
# Create small matrices with incompatible dimensions
mu <- c(1, 2)
ortho_m <- matrix(1:4, nrow = 2, ncol = 2)   # 2x2
env_m <- matrix(1:6, nrow = 3, ncol = 2)     # 3x2 (incompatible: ortho_m.ncol != env_m.nrow)
dl_mat <- diag(2)
drl_mat <- diag(2)
like_ltsg(mu, env_m, dl_mat, drl_mat, ortho_m, q = 1, r = 2)
# Expect an error with the specific message
expect_error(
# like_ltsg(mu, env_m, dl_mat, drl_mat, ortho_m, q = 1, r = 2),
"Matrix dimensions are not compatible for multiplication."
)
# In testestthat# In tests/testthat/test-like_ltsg.R
test_that("like_ltsg throws error for incompatible matrix dimensions", {
# Create small matrices with incompatible dimensions
mu <- c(1, 2)
ortho_m <- matrix(1:4, nrow = 2, ncol = 2)   # 2x2
env_m <- matrix(1:6, nrow = 3, ncol = 2)     # 3x2 (incompatible: ortho_m.ncol != env_m.nrow)
dl_mat <- diag(2)
drl_mat <- diag(2)
# Expect an error with the specific message
expect_error(
# like_ltsg(mu, env_m, dl_mat, drl_mat, ortho_m, q = 1, r = 2),
"Matrix dimensions are not compatible for multiplication."
)
})
library(testthat)
# In testestthat# In tests/testthat/test-like_ltsg.R
test_that("like_ltsg throws error for incompatible matrix dimensions", {
# Create small matrices with incompatible dimensions
mu <- c(1, 2)
ortho_m <- matrix(1:4, nrow = 2, ncol = 2)   # 2x2
env_m <- matrix(1:6, nrow = 3, ncol = 2)     # 3x2 (incompatible: ortho_m.ncol != env_m.nrow)
dl_mat <- diag(2)
drl_mat <- diag(2)
# Expect an error with the specific message
expect_error(
# like_ltsg(mu, env_m, dl_mat, drl_mat, ortho_m, q = 1, r = 2),
"Matrix dimensions are not compatible for multiplication."
)
})
like_ltsg(mu, env_m, dl_mat, drl_mat, ortho_m, q = 1, r = 2)
# In testestthat# In tests/testthat/test-like_ltsg.R
test_that("like_ltsg throws error for incompatible matrix dimensions", {
# Create small matrices with incompatible dimensions
mu <- c(1, 2)
ortho_m <- matrix(1:4, nrow = 2, ncol = 2)   # 2x2
env_m <- matrix(1:6, nrow = 3, ncol = 2)     # 3x2 (incompatible: ortho_m.ncol != env_m.nrow)
dl_mat <- diag(2)
drl_mat <- diag(2)
# Expect an error with the specific message
expect_error(
# like_ltsg(mu, env_m, dl_mat, drl_mat, ortho_m, q = 1, r = 2),
"Matrix dimensions are not compatible for multiplication"
)
})
library(testthat)
# In testestthat# In tests/testthat/test-like_ltsg.R
test_that("like_ltsg throws error for incompatible matrix dimensions", {
# Create small matrices with incompatible dimensions
mu <- c(1, 2)
ortho_m <- matrix(1:4, nrow = 2, ncol = 2)   # 2x2
env_m <- matrix(1:6, nrow = 3, ncol = 2)     # 3x2 (incompatible: ortho_m.ncol != env_m.nrow)
dl_mat <- diag(2)
drl_mat <- diag(2)
# Expect an error with the specific message
expect_error(
# like_ltsg(mu, env_m, dl_mat, drl_mat, ortho_m, q = 1, r = 2),
"Matrix dimensions are not compatible for multiplication"
)
})
covr::report()
env_dat
optim_mll
# Use the same simulated data
env_dat <- array(c(
13, 13, 12, 2, 3, 3,
13, 13, 12, 2, 3, 4
), dim = c(2, 3, 4))
env_dat
dim(env_dat)
# Use the same simulated data
env_dat <- array(c(
13, 12, 3,
13, 12, 4
), dim = c(2, 3, 4))
env_dat
# Use the same simulated data
env_dat <- array(c(
13, 13, 12, 2, 3, 3,
15, 16, 15, 3, 5, 3,
14, 14, 13, 2, 3, 3,
13, 13, 12, 2, 3, 4
), dim = c(2, 3, 4))
env_dat
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
runif(2 * 3 * 2)
runif
env_dat <- array(runif(2 * 3 * 2, min = 4, max = 12), dim = c(2, 3, 2))
like_neg_ltsgr_cpp(env_dat, mu, sigl, sigr, o_mat)
o_mat <- matrix(c(-0.4, 0.9, -0.9, -0.4), ncol = 2)
mu <- c(11, 5)
sigl <- c(1, 1.5)
sigr <- c(1.5, 1.4)
env_dat <- array(runif(2 * 3 * 2, min = 4, max = 12), dim = c(2, 3, 2))
like_neg_ltsgr_cpp(env_dat, mu, sigl, sigr, o_mat)
like_neg_ltsgr_cpp(env_dat, mu, sigl, sigr, o_mat)
like_neg_ltsgr_cpp(env_dat, mu, sigl, sigr, o_mat, negative = TRUE)
like_neg_ltsgr_cpp
lintr::lint_package()
# Add the scaffolding for code coverage with Codecov
usethis::use_coverage(type = "codecov")
usethis::use_coverage(type = "codecov")
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
lintr::lint_package()
covr::package_coverage()
covr::codecov()
covr::codecov(token = "4767bbe-59db-46b9-8468-a96974825268", repo = "alrobles/xsdmMle")
lintr::lint_package()
lintr::lint_package()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
lintr::lint_package()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
library("goodpractice")
goodpractice::gp()
library(pkgdown)
pkgdown::build_site_github_pages()
pkgdown::deploy_site_github()
# Run once to configure your package to use and deploy pkgdown
usethis::use_pkgdown_github_pages()
# Preview your site locally before publishing
pkgdown::build_site()
use_pkgdown()
library(usethis)
use_pkgdown()
use_github_pages()
usethis::gh_token_help()
usethis::create_github_token()
gitcreds::gitcreds_set()
usethis::gh_token_help()
usethis::git_remotes()
usethis::use_github_pages()
https://alrobles.github.io/xsdmMle/
